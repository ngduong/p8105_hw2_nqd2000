---
title: "P8105 HW2"
author: "Ngoc Duong"
date: "10/03/2019"
output: github_document
editor_options: 
  chunk_output_type: console
---
### Problem 1
```{r setup, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(knitr)
# read and clean Mr. Trash Wheel sheet
trash_data <- 
  read_excel("./subdirectory/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
            sheet = "Mr. Trash Wheel") %>%
            janitor::clean_names() %>%
            select(-c("x15","x16","x17")) %>%   # deselect variables that don't give useful information and have too many NA's
            drop_na() %>%                       # omit rows that do not include dumpster specific data
            mutate(       
              sports_balls = round(sports_balls, 0)) %>% # round sports_balls to nearest integers
            mutate(
              sports_balls = as.integer(sports_balls))   # convert sports_balls into an integer variable
```

```{r precipitation 2017 and 2018, message=FALSE, warning=FALSE}

#read and clean precipitation data for 2017 and 2018
precip_2018 <- 
  read_excel("./subdirectory/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
            sheet = "2018 Precipitation", skip = 1) %>%  # select appropriate sheet, load, and skip first header/row because it doesn't contain info 
            janitor::clean_names() %>%
            drop_na() %>%                       # omit rows without precipitation data 
            rename (precip_total = total) %>%   # rename precip_total variable 
            mutate(year = 2018)                 # add variable year for 2018

precip_2017 <- 
  read_excel("./subdirectory/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
            sheet = "2017 Precipitation", skip = 1) %>%  # select appropriate sheet, load, and skip first header/row because it doesn't contain info 
            janitor::clean_names() %>%          
            drop_na() %>%                       # omit rows without precipitation data 
            rename(precip_total = total) %>%    # rename precip_total variable 
            mutate(year = 2017)                 # add variable year for 2017

# Combine dataset and convert month to character variable
precip_merged = 
  left_join(
    precip_2017, precip_2018, by = "month") %>% # combine using left_join
  mutate(
    month = month.name[month],                  # turn month into a character variable using month.name[] 
    month = str_to_lower(month)) %>%            # make lower case strings (to standardize across datasets)
  rename (
    precip_2017 = precip_total.x,               # rename variable to avoid year confusion
    precip_2018 = precip_total.y) %>% 
  select(-c("year.x","year.y"))                 # drop year variables because not necessary and can be confusing 

```

Mr. Trash Wheel dataset has `r nrow(trash_data)` observations (rows) of `r ncol(trash_data)` variables. Key dumpster- and time-specific (identifying) variables include ``r names(trash_data)[1:4]``, and dumpster characteristic variables are ``r names(trash_data)[5:7]``, while the rest, such as ``r names(trash_data)[7:11]``, etc. show the amounts of each trash type in the dumpsters. More specifically, for example, median number of sports balls in a dumpster in 2017 was `r trash_data %>% filter(year == "2017") %>% summarize(median(sports_balls))` balls.

The 2017 preciptation dataset has `r count(precip_2017)` observations, and the 2018 precipitation dataset has `r count(precip_2018)` observations. Key variables for both precipitation datasets include `month`, `year`, and `precip_total` denoting total precipitation for each month. Total precipitation in 2018 (for the months with available data) was `r sum(pull(precip_merged, precip_2018), na.rm = TRUE)`, while total precipitation in 2017 was `r sum(pull(precip_merged, precip_2017), na.rm = TRUE)`. 
